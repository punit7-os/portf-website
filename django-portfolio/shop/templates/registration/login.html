{% extends "shop/base.html" %}
{% load socialaccount %}
{% load static %}
{% load i18n %}

{% block title %}Login - My Shoppings{% endblock %}

{% block content %}
<div style="
  max-width:420px;
  margin:40px auto;
  padding:28px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 6px 20px rgba(0,0,0,0.06);
">
  <h2 style="margin-top:0;text-align:center;">Login</h2>

  {% if error %}
    <div style="color:#b00020;margin-bottom:12px;text-align:center;">
      {{ error }}
    </div>
  {% endif %}

  <!-- Google Login -->
  <div style="margin-bottom:16px;">
    <a href="{% provider_login_url 'google' process='login' %}"
       style="
        display:flex;
        align-items:center;
        justify-content:center;
        gap:10px;
        padding:10px;
        border-radius:8px;
        border:1px solid #e6edf8;
        text-decoration:none;
        font-weight:600;
       ">
      <img src="{% static 'images/google-logo.png' %}" alt="Google" style="width:20px;height:20px;">
      Sign in with Google
    </a>
  </div>

  <div style="text-align:center;color:#666;margin-bottom:16px;">
    <small>Or login with email or username</small>
  </div>

  <form method="post">
    {% csrf_token %}

    <!-- Email / Username (MATCHED WIDTH) -->
    <div style="margin-bottom:16px;">
      <label style="display:block;font-weight:600;margin-bottom:6px;">
        Email or Username
      </label>

      <div style="
        display:flex;
        align-items:center;
        border:1px solid #ddd;
        border-radius:6px;
      ">
        <input type="text"
               name="identifier"
               required
               value="{{ request.POST.identifier }}"
               style="
                flex:1;
                padding:10px;
                border:none;
                outline:none;
               ">
      </div>
    </div>

    <!-- Password (SAME STRUCTURE) -->
    <div style="margin-bottom:20px;">
      <label style="display:block;font-weight:600;margin-bottom:6px;">
        Password
      </label>

      <div style="
        display:flex;
        align-items:center;
        border:1px solid #ddd;
        border-radius:6px;
      ">
        <input type="password"
               id="passwordField"
               name="password"
               required
               style="
                flex:1;
                padding:10px;
                border:none;
                outline:none;
               ">

        <button type="button"
                id="togglePassword"
                style="
                  background:none;
                  border:none;
                  color:#007BFF;
                  font-size:13px;
                  font-weight:600;
                  cursor:pointer;
                  padding:6px 10px;
                ">
          SHOW
        </button>
      </div>
    </div>

    <!-- Buttons -->
    <div style="display:flex;gap:10px;align-items:center;">
      <button type="submit"
              style="
                flex:1;
                padding:10px;
                border-radius:8px;
                border:none;
                background:#007BFF;
                color:white;
                font-weight:600;
              ">
        Login
      </button>

      <a href="{% url 'shop:signup' %}"
         style="
          padding:8px 14px;
          border-radius:8px;
          background:#f1f5fb;
          color:#007BFF;
          text-decoration:none;
          font-weight:600;
         ">
        Signup
      </a>
    </div>

    <input type="hidden" name="next" value="{{ next }}">
  </form>

  <div style="margin-top:14px;text-align:center;">
    <a href="{% url 'account_reset_password' %}">Forgot password?</a>
  </div>
</div>

<script>
  const toggleBtn = document.getElementById("togglePassword");
  const passwordInput = document.getElementById("passwordField");

  toggleBtn.addEventListener("click", () => {
    if (passwordInput.type === "password") {
      passwordInput.type = "text";
      toggleBtn.textContent = "HIDE";
    } else {
      passwordInput.type = "password";
      toggleBtn.textContent = "SHOW";
    }
  });
</script>
{% endblock %}
